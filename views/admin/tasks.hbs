<div class="bg-white industrial-border overflow-hidden">
    <div class="overflow-x-auto">
        <table class="w-full text-left border-collapse">
            <thead>
                <tr class="bg-[#2F3640] text-white text-xs uppercase tracking-wider font-mono">
                    <th class="px-4 py-3 border-b border-[#7F8C8D]">取件码</th>
                    <th class="px-4 py-3 border-b border-[#7F8C8D]">用户UID</th>
                    <th class="px-4 py-3 border-b border-[#7F8C8D]">下单时间</th>
                    <th class="px-4 py-3 border-b border-[#7F8C8D]">规格</th>
                    <th class="px-4 py-3 border-b border-[#7F8C8D]">附件</th>
                    <th class="px-4 py-3 border-b border-[#7F8C8D]">状态</th>
                    <th class="px-4 py-3 border-b border-[#7F8C8D]">操作</th>
                </tr>
            </thead>
            <tbody class="text-sm font-mono">
                {{#if tasks.length}}
                    {{#each tasks}}
                    <tr class="hover:bg-[#F5F6FA] transition-colors border-b border-[#F5F6FA]">
                        <td class="px-4 py-4 font-bold text-[#2F3640]">{{this.pickupCode}}</td>
                        <td class="px-4 py-4 text-[#7F8C8D]">{{#if this.userUid}}{{this.userUid}}{{else}}匿名{{/if}}</td>
                        <td class="px-4 py-4 text-xs text-[#7F8C8D]">{{this.createTime}}</td>
                        <td class="px-4 py-4">
                            <div class="flex flex-col">
                                <span class="font-bold text-xs">{{this.color}} | {{this.sides}}</span>
                                <span class="text-[10px] text-[#7F8C8D]">x {{this.copies}} 份</span>
                            </div>
                        </td>
                        <td class="px-4 py-4">
                            <div class="flex flex-wrap gap-2">
                                {{#each this.files}}
                                <a href="{{this.downloadURL}}" target="_blank" download="{{this.name}}" 
                                   class="inline-flex items-center px-2 py-1 bg-white border border-[#F5F6FA] text-[10px] text-[#44BD32] hover:border-[#44BD32] transition-colors"
                                   title="{{this.name}}">
                                    <i class="fas fa-download mr-1"></i>
                                    <span class="truncate max-w-[80px]">{{this.name}}</span>
                                </a>
                                {{/each}}
                            </div>
                        </td>
                        <td class="px-4 py-4">
                            <span class="status-{{this.status}} font-bold text-[10px] uppercase">
                                {{#if (eq this.status 'pending')}}待处理{{/if}}
                                {{#if (eq this.status 'processing')}}打印中{{/if}}
                                {{#if (eq this.status 'completed')}}已完成{{/if}}
                            </span>
                        </td>
                        <td class="px-4 py-4">
                            <div class="flex space-x-2">
                                {{#unless (eq this.status 'completed')}}
                                    {{#if (eq this.status 'pending')}}
                                    <form action="/tasks/{{this._id}}/status" method="POST">
                                        <input type="hidden" name="status" value="processing">
                                        <button type="submit" class="p-2 bg-[#F1C40F] text-white hover:bg-[#D4AC0D]" title="开始打印">
                                            <i class="fas fa-spinner"></i>
                                        </button>
                                    </form>
                                    {{/if}}
                                    <form action="/tasks/{{this._id}}/status" method="POST">
                                        <input type="hidden" name="status" value="completed">
                                        <button type="submit" class="p-2 bg-[#44BD32] text-white hover:bg-[#27AE60]" title="完成任务">
                                            <i class="fas fa-check"></i>
                                        </button>
                                    </form>
                                {{/unless}}
                            </div>
                        </td>
                    </tr>
                    {{#if this.remark}}
                    <tr class="bg-[#F5F6FA]/50 border-b border-[#F5F6FA]">
                        <td colspan="7" class="px-4 py-2 text-xs italic text-[#7F8C8D]">
                            <span class="font-bold not-italic mr-2">备注:</span> "{{this.remark}}"
                        </td>
                    </tr>
                    {{/if}}
                    {{/each}}
                {{else}}
                    <tr>
                        <td colspan="7" class="py-20 text-center text-[#7F8C8D] uppercase tracking-widest">
                            <i class="fas fa-inbox text-2xl mb-2 block"></i>
                            暂无活跃任务
                        </td>
                    </tr>
                {{/if}}
            </tbody>
        </table>
    </div>
</div>
